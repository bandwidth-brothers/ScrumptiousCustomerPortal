<div class="mat-elevation-z8" *ngIf="dataSource">

    <table mat-table [dataSource]="dataSource" multiTemplateDataRows>

        <!-- Id Column -->
        <ng-container matColumnDef="Id">
            <th mat-header-cell *matHeaderCellDef> # </th>
            <td mat-cell *matCellDef="let order; let i = dataIndex"> {{i + 1}} </td>
        </ng-container>

        <!-- Restaurant Column, could be null on current order -->
        <ng-container matColumnDef="Restaurant">
            <th mat-header-cell *matHeaderCellDef> Restaurant </th>
            <td mat-cell *matCellDef="let order"> {{order.restaurant?.name}} </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="Status">
            <th mat-header-cell *matHeaderCellDef> Order status </th>
            <td mat-cell *matCellDef="let order" [ngStyle]="{
                'background-color': 
            order.preparationStatus == 'Cancelled' ? '#ff5c5c' : 
            order.preparationStatus == 'Order Placed' ? '#ffd300' : 
            order.preparationStatus == 'Preparing' ? '#d8f000' : ''}">
                {{order.preparationStatus}} </td>
        </ng-container>

        <!-- ConfirmationCode Column -->
        <ng-container matColumnDef="ConfirmationCode">
            <th mat-header-cell *matHeaderCellDef> Confirmation code </th>
            <td mat-cell *matCellDef="let order"> {{order.confirmationCode}} </td>
        </ng-container>

        <!-- SubmittedAt Column -->
        <ng-container matColumnDef="SubmittedAt">
            <th mat-header-cell *matHeaderCellDef> Submitted At </th>
            <td mat-cell *matCellDef="let order"> {{order.submitedAt | date:'short'}} </td>
        </ng-container>

        <!-- RequestedTime Column -->
        <ng-container matColumnDef="RequestedTime">
            <th mat-header-cell *matHeaderCellDef> Requested Time </th>
            <td mat-cell *matCellDef="let order"> {{order.requestedDeliveryTime | date:'short'}} </td>
        </ng-container>

        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let order" [attr.colspan]="displayedColumns.length">
                <div class="example-element-detail" [@detailExpand]="order == expandedOrder ? 'expanded' : 'collapsed'">
                    <div class="dataTable-container">

                        <mat-list>
                            <mat-list-item *ngFor="let menuitemOrder of order.menuitemOrders">
                                <mat-icon mat-list-icon>restaurant_menu</mat-icon>
                                <h3 mat-line>{{ menuitemOrder.menuitem.name }} - {{ menuitemOrder.quantity }}</h3>
                                <p mat-line>${{ (menuitemOrder.quantity * menuitemOrder.menuitem.price) | number:
                                    '1.2-2'}}</p>
                            </mat-list-item>

                        </mat-list>
                        <button [disabled]="!isCancellable(order)" mat-raised-button style="margin-bottom: 10px;"
                            color="primary" (click)="editOrder(order)">Edit order</button>
                        <button [disabled]="!isCancellable(order)" mat-raised-button style="margin-bottom: 10px;"
                            color="warn" (click)="cancelOrder(order)">Cancel order</button>
                    </div>


                </div>
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let order; columns: displayedColumns;" class="example-element-row"
            [class.example-expanded-row]="expandedOrder === order"
            (click)="expandedOrder = expandedOrder === order ? null : order">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
    </table>
</div>